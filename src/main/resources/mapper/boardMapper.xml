<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.board.mapper.BoardMapper">
    <resultMap id="boardResultMap" type="com.example.board.model.Board">
        <id column="BOARDID" property="boardid"/>
        <result column="TITLE" property="title"/>
        <result column="CONTENT" property="content"/>
        <result column="REGDATE" property="regdate"/>
    </resultMap>

    <select id="selectBoardList" parameterType="com.example.board.model.Page" resultMap="boardResultMap">
        SELECT
            (totcount - rownum) + 1 AS NO,
            boardid,
            title,
            content,
            regdate
        FROM
            (SELECT
                ROW_NUMBER() OVER (ORDER BY regdate asc) AS rownum,
               boardid,
               title,
               content,
               regdate,
               (SELECT COUNT(boardid) FROM board ) AS totcount
            FROM
               board) AS T1
        WHERE 1 = 1
        <choose>
            <when test="pageNum >= 2 and pageNum != null">
                LIMIT 10 * (#{pageNum} - 1) , #{pageLength}
            </when>
            <otherwise>
                LIMIT 0, 10
            </otherwise>
        </choose>
    </select>
</mapper>